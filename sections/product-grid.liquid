{% assign collection = collections[section.settings.collection] %}

{% if collection and collection.products.size > 0 %}
  {%- paginate collection.products by section.settings.product_count -%}
    <section class="product-selling-section style section-padding pl-60">
      <div class="product-wrap">
        <div class="container-fluid">
          <div class="row">
            {% for product in collection.products %}
              {% assign compare_price = product.variants.first.compare_at_price %}
              {% assign product_price = product.variants.first.price %}
              
              <div class="col-xl-3 col-lg-4 col-md-6 col-6">
                <div class="product-item wow fadeInUp d-flex flex-column" data-wow-duration="1000ms">
                  <div class="product-img">
                    <a href="{{ product.url }}" class="product-image">
                      <div class="image-wrap">
                        <img class="image1 hover-image"
                            src="{{ product.featured_image | image_url: width: 900 }}"
                            alt="{{ product.title }}">
                        <img class="image2 hidden-image"
                            src="{{ product.images[1] | image_url: width: 900 }}"
                            alt="{{ product.title }}">
                      </div>
                    </a>

                    {% if product.metafields.custom.text_highlight and product.metafields.custom.text_highlight.value != blank %}
                      <div class="custom-text-badge">
                        {{ product.metafields.custom.text_highlight.value }}
                      </div>
                    {% endif %}
                  </div>

                  <div class="product-info text-center">
                    <h2><a href="{{ product.url }}">{{ product.title }}</a></h2>

                    {% if product.tags contains '1 Colors' %}<p>1 Color</p>{% endif %}
                    {% if product.tags contains '2 Colors' %}<p>2 Colors</p>{% endif %}
                    {% if product.tags contains '3 Colors' %}<p>3 Colors</p>{% endif %}
                    {% if product.tags contains '4 Colors' %}<p>4 Colors</p>{% endif %}
                    {% if product.tags contains '5 Colors' %}<p>5 Colors</p>{% endif %}

                    <div class="price">
                      {% if compare_price and compare_price > product_price %}
                        <span class="discounted-price">{{ cart.currency.symbol }}{{ product_price | money_without_currency }}</span>
                        <span class="original-price" style="text-decoration: line-through; color: gray;">
                          {{ cart.currency.symbol }}{{ compare_price | money_without_currency }}
                        </span>
                      {% else %}
                        <span class="discounted-price">{{ cart.currency.symbol }}{{ product_price | money_without_currency }}</span>
                      {% endif %}
                    </div>

                    <div class="cart-btn sliderAddToCart" data-itemid="{{ product.variants.first.id }}">
                      <a href="#" class="theme-btn cartBtn">Add to Cart</a>
                      <a href="#" class="theme-btn loadingBtn" style="display: none;">Loading..</a>
                    </div>
                  </div>
                </div>
              </div>
            {% endfor %}
          </div>
        </div>
      </div>
    </section>
  {%- endpaginate -%}
{% else %}
  <p>No products found in the selected collection.</p>
{% endif %}
